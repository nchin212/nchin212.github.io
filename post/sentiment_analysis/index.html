<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Sentiment Analysis | Nicholas Chin Wei Lun</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.75.1" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="https://nchin212.github.io/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      

    

    
    
    <meta property="og:title" content="Sentiment Analysis" />
<meta property="og:description" content="Classifying Amazon video game reviews as positive or negative" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nchin212.github.io/post/sentiment_analysis/" />
<meta property="article:published_time" content="2021-01-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-05T00:00:00+00:00" />
<meta itemprop="name" content="Sentiment Analysis">
<meta itemprop="description" content="Classifying Amazon video game reviews as positive or negative">
<meta itemprop="datePublished" content="2021-01-05T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-05T00:00:00+00:00" />
<meta itemprop="wordCount" content="2785">



<meta itemprop="keywords" content="Python,SentimentAnalysis,NaturalLanguageProcessing,NaiveBayes,LogisticRegression,SVM," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Sentiment Analysis"/>
<meta name="twitter:description" content="Classifying Amazon video game reviews as positive or negative"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  
  
  <header class="cover bg-top" style="background-image: url('https://nchin212.github.io/images/sentiment_analysis/sentiment.jpg');">
    <div class="pb3-m pb6-l bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://nchin212.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Nicholas Chin Wei Lun
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://nchin212.github.io/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://nchin212.github.io/contact/" title="Contact page">
              Contact
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://nchin212.github.io/post/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      








<a href="https://github.com/nchin212" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








    </div>
  </div>
</nav>

      <div class="tc-l pv6 ph3 ph4-ns">
        
          <h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Sentiment Analysis</h1>
          
            <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
              Classifying Amazon video game reviews as positive or negative
            </h2>
          
        
      </div>
    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://nchin212.github.io/post/sentiment_analysis/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://nchin212.github.io/post/sentiment_analysis/&amp;text=Sentiment%20Analysis" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://nchin212.github.io/post/sentiment_analysis/&amp;title=Sentiment%20Analysis" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Sentiment Analysis</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2021-01-05T00:00:00Z">January 5, 2021</time>

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Sentiment Analysis is a natural language processing technique used to determine whether the data is positive, negative or neutral. It helps companies monitor brand and product reputation and gauge customer sentiments on their products from customer reviews. In this project, we will be examining Amazon reviews for video games and using naive bayes, logistic regression and support vector machines for sentiment analysis. We will also be comparing between 2 tokenization techniques, CountVectorizer and TfidfVectorizer in scikit-learn.</p>
<h2 id="data">Data</h2>
<p>The data contains a collection of video game reviews written in the Amazon.com marketplace and associated metadata from 1995 until 2015 and can be downloaded <a href="https://s3.amazonaws.com/amazon-reviews-pds/tsv/amazon_reviews_us_Video_Games_v1_00.tsv.gz">here</a>. It contains the following columns:</p>
<p><strong>marketplace</strong> - 2 letter country code of the marketplace where the review was written.</p>
<p><strong>customer_id</strong> - Random identifier that can be used to aggregate reviews written by a single author.</p>
<p><strong>review_id</strong> - The unique ID of the review.</p>
<p><strong>product_id</strong> - The unique Product ID the review pertains to.</p>
<p><strong>product_parent</strong> - Random identifier that can be used to aggregate reviews for the same product.</p>
<p><strong>product_title</strong>  - Title of the product.</p>
<p><strong>product_category</strong>  - Broad product category that can be used to group reviews (also used to group the dataset into coherent parts).</p>
<p><strong>star_rating</strong>  - The 1-5 star rating of the review.</p>
<p><strong>helpful_votes</strong> - Number of helpful votes.</p>
<p><strong>total_votes</strong>  - Number of total votes the review received.</p>
<p><strong>vine</strong> - Review was written as part of the Vine program.</p>
<p><strong>verified_purchase</strong> - The review is on a verified purchase.</p>
<p><strong>review_headline</strong> - The title of the review.</p>
<p><strong>review_body</strong> - The review text.</p>
<p><strong>review_date</strong> - The date the review was written.</p>
<h2 id="loading-in-the-data">Loading in the Data</h2>
<p>Load in the required libraries.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> re
<span style="color:#f92672">import</span> string

<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns
sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#34;whitegrid&#34;</span>)
<span style="color:#f92672">from</span> wordcloud <span style="color:#f92672">import</span> WordCloud

<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.feature_extraction.text <span style="color:#f92672">import</span> CountVectorizer, TfidfVectorizer
<span style="color:#f92672">from</span> nltk.corpus <span style="color:#f92672">import</span> stopwords

<span style="color:#f92672">from</span> sklearn.naive_bayes <span style="color:#f92672">import</span> MultinomialNB
<span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVC
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix, classification_report, accuracy_score, precision_score, recall_score, f1_score

<span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#39;ignore&#39;</span>)
</code></pre></div><p>Read in the zip file into a dataframe and check the first few rows.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfAmazon <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;amazon_reviews_us_Video_Games_v1_00.tsv.gz&#39;</span>, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>, compression<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gzip&#39;</span>, error_bad_lines<span style="color:#f92672">=</span>False)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfAmazon<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>   marketplace customer_id	review_id	product_id	product_parent	product_title	                                     product_category	star_rating helpful_votes total_votes vine verified_purchase review_headline	                                review_body	                                        review_date
0	US	12039526	RTIS3L2M1F5SM	B001CXYMFS	737716809	Thrustmaster T-Flight Hotas X Flight Stick	        Video Games	     5	          0	       0	N	Y	    an amazing joystick. I especially love that yo...	Used this for Elite Dangerous on my mac, an am...	2015-08-31
1	US	9636577	        R1ZV7R40OLHKD	B00M920ND6	569686175	Tonsee 6 buttons Wireless Optical Silent Gamin...	Video Games	     5	          0	       0	N	Y	    Definitely a silent mouse... Not a single clic...	Loved it, I didn't even realise it was a gami...	2015-08-31
2	US	2331478	        R3BH071QLH8QMC	B0029CSOD2	98937668	Hidden Mysteries: Titanic Secrets of the Fatef...	Video Games	     1	          0	       1	N	Y	    One Star	                                        poor quality work and not as it is advertised.	        2015-08-31
3	US	52495923	R127K9NTSXA2YH	B00GOOSV98	23143350	GelTabz Performance Thumb Grips - PlayStation ...	Video Games	     3	          0	       0	N	Y	    good, but could be bettee	                        nice, but tend to slip away from stick in inte...	2015-08-31
4	US	14533949	R32ZWUXDJPW27Q	B00Y074JOM	821342511	Zero Suit Samus amiibo - Japan Import (Super S...	Video Games	     4	          0	       0	N	Y	    Great but flawed.	                                Great amiibo, great for collecting. Quality ma...	2015-08-31
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfAmazon<span style="color:#f92672">.</span>shape
</code></pre></div><pre><code>(1780268, 15)
</code></pre>
<h2 id="data-cleaning">Data Cleaning</h2>
<p>Check for missing values.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfAmazon<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>sum()
</code></pre></div><pre><code>marketplace           0
customer_id           0
review_id             0
product_id            0
product_parent        0
product_title         0
product_category      0
star_rating           0
helpful_votes         0
total_votes           0
vine                  0
verified_purchase     0
review_headline      28
review_body          59
review_date          27
dtype: int64
</code></pre>
<p>Remove missing values from &lsquo;review_body&rsquo;.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dfAmazon<span style="color:#f92672">.</span>dropna(subset<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;review_body&#39;</span>], inplace<span style="color:#f92672">=</span>True)
</code></pre></div><p>We will only be using the columns &lsquo;star_rating&rsquo; and &lsquo;review_body&rsquo; for analysis.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews <span style="color:#f92672">=</span> dfAmazon[[<span style="color:#e6db74">&#39;star_rating&#39;</span>, <span style="color:#e6db74">&#39;review_body&#39;</span>]]<span style="color:#f92672">.</span>copy()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>   star_rating  review_body
0            5  Used this for Elite Dangerous on my mac, an am...
1            5  Loved it,  I didn't even realise it was a gami...
2            1  poor quality work and not as it is advertised.
3            3  nice, but tend to slip away from stick in inte...
4            4  Great amiibo, great for collecting. Quality ma...
</code></pre>
<p>Add in a new column &lsquo;good_review&rsquo; that converts the star rating to a binary class, where 1 represents that the review is good and 0 represents that the review is bad.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews[<span style="color:#e6db74">&#39;good_review&#39;</span>] <span style="color:#f92672">=</span> amazonReviews<span style="color:#f92672">.</span>star_rating
amazonReviews<span style="color:#f92672">.</span>good_review[amazonReviews<span style="color:#f92672">.</span>star_rating <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
amazonReviews<span style="color:#f92672">.</span>good_review[amazonReviews<span style="color:#f92672">.</span>star_rating <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">5</span>)
</code></pre></div><pre><code>    star_rating review_body	                                 good_review
560028	5	It great ! Thanks !	                                1
410884	5	Got this as a gift for my hubby and he loves i...	1
1499338	2	I got it as a christmas gift for my boyfriend'...	0
343289	4	I would like to give some clarity on this prod...	1
628404	4	they are still raving about them; of course th...	1
</code></pre>
<p>Remove duplicate reviews.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews <span style="color:#f92672">=</span> amazonReviews<span style="color:#f92672">.</span>drop_duplicates(subset <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;review_body&#39;</span>])
</code></pre></div><h2 id="text-cleaning">Text Cleaning</h2>
<p>Create function that makes text lowercase, removes text in square brackets, removes punctuation and removes words containing numbers.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">clean_text</span>(text):
    text <span style="color:#f92672">=</span> text<span style="color:#f92672">.</span>lower()
    text <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;\[.*?\]&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, text)
    text <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">]&#39;</span> <span style="color:#f92672">%</span> re<span style="color:#f92672">.</span>escape(string<span style="color:#f92672">.</span>punctuation), <span style="color:#e6db74">&#39;&#39;</span>, text)
    text <span style="color:#f92672">=</span> re<span style="color:#f92672">.</span>sub(<span style="color:#e6db74">&#39;\w*\d\w*&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>, text)
    <span style="color:#66d9ef">return</span> text
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">amazonReviews[<span style="color:#e6db74">&#39;review_body&#39;</span>] <span style="color:#f92672">=</span> amazonReviews[<span style="color:#e6db74">&#39;review_body&#39;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: clean_text(x))
</code></pre></div><p>Remove stopwords from the texts.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stop <span style="color:#f92672">=</span> stopwords<span style="color:#f92672">.</span>words(<span style="color:#e6db74">&#39;english&#39;</span>)

amazonReviews[<span style="color:#e6db74">&#39;review_body&#39;</span>] <span style="color:#f92672">=</span> amazonReviews[<span style="color:#e6db74">&#39;review_body&#39;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x<span style="color:#f92672">.</span>split() <span style="color:#66d9ef">if</span> x <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> stop))
amazonReviews[<span style="color:#e6db74">&#39;review_body&#39;</span>]<span style="color:#f92672">.</span>sample(<span style="color:#ae81ff">10</span>)
</code></pre></div><pre><code>1092404    basic knowledge bulletstorm one see another ge...
1099499    would mistaken oh young seeker knowledge respe...
133640     retroduo portable amazing many ways feels look...
868933     say something ive never tried grandson smiling...
1774215    completed first two tomb raider games impresse...
208092         great product came exactly described business
1230563    uncharted drakes fortune solid game doubt cont...
1293668    announced nba elite canceled coming full game ...
1596700    game enjoyable battle system requires strategy...
1657335    wonderful cdrom daughter much fun playing lear...
Name: review_body, dtype: object
</code></pre>
<p>Split the data into training and test sets.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sampled_reviews <span style="color:#f92672">=</span> amazonReviews<span style="color:#f92672">.</span>sample(n <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
X <span style="color:#f92672">=</span> sampled_reviews<span style="color:#f92672">.</span>review_body
y <span style="color:#f92672">=</span> sampled_reviews<span style="color:#f92672">.</span>good_review

X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.30</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">42</span>)
</code></pre></div><h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<h3 id="distribution-of-star-ratings">Distribution of Star Ratings</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sampled_reviews<span style="color:#f92672">.</span>star_rating<span style="color:#f92672">.</span>value_counts(ascending <span style="color:#f92672">=</span> False)<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bar&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;forestgreen&#39;</span>,figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">6</span>))

plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Star Ratings&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Number of Reviews&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Distribution of Star Ratings&#39;</span>)
</code></pre></div><pre><code>Text(0.5, 1.0, 'Distribution of Star Ratings')
</code></pre>
<p><img src="https://nchin212.github.io/images/sentiment_analysis/bar1.png" alt="png"></p>
<p>There appears to be many more customers who give a high number of stars (4 or 5) as compared to low number of stars.</p>
<h3 id="distribution-of-number-of-words">Distribution of Number of Words</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sampled_reviews<span style="color:#f92672">.</span>review_body<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>split()<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>len()<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;hist&#39;</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;red&#39;</span>,figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">6</span>), range<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">600</span>))


plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#34;Number of Words&#34;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Number of Reviews&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Distribution of Number of Words&#39;</span>)
</code></pre></div><pre><code>Text(0.5, 1.0, 'Distribution of Number of Words')
</code></pre>
<p><img src="https://nchin212.github.io/images/sentiment_analysis/bar2.png" alt="png"></p>
<h3 id="distribution-of-good-reviews">Distribution of Good Reviews</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sampled_reviews_positive <span style="color:#f92672">=</span> sampled_reviews[sampled_reviews[<span style="color:#e6db74">&#39;good_review&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>]
sampled_reviews_negative <span style="color:#f92672">=</span> sampled_reviews[sampled_reviews[<span style="color:#e6db74">&#39;good_review&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>]

number <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series([len(sampled_reviews_negative), len(sampled_reviews_positive)])
number<span style="color:#f92672">.</span>plot(kind<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bar&#39;</span>, color <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;blue&#39;</span>,<span style="color:#e6db74">&#39;orange&#39;</span>), figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">6</span>))

plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Number of Reviews&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Distribution of Good Reviews&#39;</span>)
</code></pre></div><pre><code>Text(0.5, 1.0, 'Distribution of Good Reviews')
</code></pre>
<p><img src="https://nchin212.github.io/images/sentiment_analysis/bar3.png" alt="png"></p>
<h3 id="most-frequent-words">Most frequent words</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">text_for_cloud <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sampled_reviews[<span style="color:#e6db74">&#39;review_body&#39;</span>])
wordcloud <span style="color:#f92672">=</span> WordCloud(background_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;white&#34;</span>)<span style="color:#f92672">.</span>generate(text_for_cloud)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">8</span>), dpi<span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
plt<span style="color:#f92672">.</span>imshow(wordcloud, interpolation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bilinear&#39;</span>)
plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/cloud1.png" alt="png"></p>
<h3 id="most-frequent-words-for-positive-sentiment">Most frequent words for positive sentiment</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">text_for_cloud <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sampled_reviews_positive[<span style="color:#e6db74">&#39;review_body&#39;</span>])
wordcloud <span style="color:#f92672">=</span> WordCloud(background_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;white&#34;</span>)<span style="color:#f92672">.</span>generate(text_for_cloud)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">8</span>), dpi<span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
plt<span style="color:#f92672">.</span>imshow(wordcloud, interpolation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bilinear&#39;</span>)
plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/cloud2.png" alt="png"></p>
<p>As expected, words such as &lsquo;good&rsquo;, &lsquo;fun&rsquo; and &lsquo;love&rsquo; can be found in the positive reviews.</p>
<h3 id="most-frequent-words-for-negative-sentiment">Most frequent words for negative sentiment</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">text_for_cloud <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">.</span>join(x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> sampled_reviews_negative[<span style="color:#e6db74">&#39;review_body&#39;</span>])
wordcloud <span style="color:#f92672">=</span> WordCloud(background_color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;white&#34;</span>)<span style="color:#f92672">.</span>generate(text_for_cloud)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span> (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">8</span>), dpi<span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>)
plt<span style="color:#f92672">.</span>imshow(wordcloud, interpolation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bilinear&#39;</span>)
plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/cloud3.png" alt="png"></p>
<p>As expected, words such as &lsquo;bad&rsquo; and &lsquo;problem&rsquo; can be found in the negative reviews. We still see some positive words such as &lsquo;good&rsquo; and &lsquo;fun&rsquo; but this is most likely due to the words &lsquo;not good&rsquo; and &lsquo;not fun&rsquo;.</p>
<h2 id="tokenization-using-countvectorizer">Tokenization using CountVectorizer</h2>
<p>The Bag-of-words model(BoW) is the simplest way of extracting features from text. BoW converts text into the matrix of occurrence of words within a document. This matrix is known as a Document-Term Matrix(DTM). In this case, we will create the DTM using CountVectorizer and only 1-gram models will be used.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">count_vect <span style="color:#f92672">=</span> CountVectorizer(ngram_range <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))
count_vect_train <span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>fit_transform(X_train)
count_vect_train <span style="color:#f92672">=</span> count_vect_train<span style="color:#f92672">.</span>toarray()
count_vect_test<span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>transform(X_test)
count_vect_test <span style="color:#f92672">=</span> count_vect_test<span style="color:#f92672">.</span>toarray()
</code></pre></div><p>View the DTM  as a dataframe. Each row represents a review and the number indicates the number of times the word appears in the review.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#f92672">.</span>DataFrame(count_vect_train, columns <span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>get_feature_names())<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>    aa   aaa    aaaaa    aaaaand  aaaaing  aaas   aaron  aas  ab  aback  ...     zora  zoras  zr  zul  zumba  zur  ðÿ  المطلوبةbr  بالجودة  ليست
0   0    0      0        0        0        0      0      0    0   0      ...     0     0      0   0    0      0    0   0           0     0
1   0    0      0        0        0        0      0      0    0   0      ...     0     0      0   0    0      0    0   0           0     0
2   0    0      0        0        0        0      0      0    0   0      ...     0     0      0   0    0      0    0   0           0     0
3   0    0      0        0        0        0      0      0    0   0      ...     0     0      0   0    0      0    0   0           0     0
4   0    0      0        0        0        0      0      0    0   0      ...     0     0      0   0    0      0    0   0           0     0
</code></pre>
<h2 id="modelling-countvectorizer">Modelling (CountVectorizer)</h2>
<p>The following models will be used to classify the text as positive or negative:</p>
<ul>
<li>Naive Bayes</li>
<li>Logistic Regression</li>
<li>Support Vector Machine (SVM)</li>
</ul>
<h3 id="naive-bayes">Naive Bayes</h3>
<p>Naive Bayes is a classification technique based on Bayes’ Theorem with an assumption of independence among predictors. It calculates the probabilities as follows:</p>
<p><img src="https://nchin212.github.io/images/sentiment_analysis/bayes.png" alt="png"></p>
<p>where y is the class variable and X refers to the features.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cv_naive <span style="color:#f92672">=</span> MultinomialNB()<span style="color:#f92672">.</span>fit(count_vect_train, y_train)
y_pred_cv_naive <span style="color:#f92672">=</span> cv_naive<span style="color:#f92672">.</span>predict(count_vect_test)
</code></pre></div><p>Plot the confusion matrix and classification report.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_cv_naive)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_cv_naive))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.78      0.42      0.55       393
           1       0.82      0.96      0.89      1107

    accuracy                           0.82      1500
   macro avg       0.80      0.69      0.72      1500
weighted avg       0.81      0.82      0.80      1500
</code></pre>
<h3 id="logistic-regression">Logistic Regression</h3>
<p>Logistic regression is an extension of linear regression to binary outcomes. It
is used to model binary outcome variable y by modeling the log odds of the outcome as a linear combination of the predictor variables X.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cv_log <span style="color:#f92672">=</span> LogisticRegression(max_iter<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>)<span style="color:#f92672">.</span>fit(count_vect_train, y_train)
y_pred_cv_log <span style="color:#f92672">=</span> cv_log<span style="color:#f92672">.</span>predict(count_vect_test)
</code></pre></div><p>Plot the confusion matrix and classification report.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_cv_log)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix2.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_cv_log))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.67      0.54      0.60       393
           1       0.85      0.91      0.88      1107

    accuracy                           0.81      1500
   macro avg       0.76      0.72      0.74      1500
weighted avg       0.80      0.81      0.80      1500
</code></pre>
<h3 id="support-vector-machine-svm">Support Vector Machine (SVM)</h3>
<p>Support vector machine attempts to find a hyperplane in an N-dimensional space (N - the number of features) that distinctly classifies the data points.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cv_svm <span style="color:#f92672">=</span> SVC(gamma<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;auto&#39;</span>)<span style="color:#f92672">.</span>fit(count_vect_train, y_train)
y_pred_cv_svm <span style="color:#f92672">=</span> cv_svm<span style="color:#f92672">.</span>predict(count_vect_test)
</code></pre></div><p>Plot the confusion matrix and classification report.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_cv_svm)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix3.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_cv_svm))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.00      0.00      0.00       393
           1       0.74      1.00      0.85      1107

    accuracy                           0.74      1500
   macro avg       0.37      0.50      0.42      1500
weighted avg       0.54      0.74      0.63      1500
</code></pre>
<h3 id="summary-of-results">Summary of Results</h3>
<p>Create a table that collates the results from the classification tables.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">classification_table</span>(y_test, <span style="color:#f92672">*</span>args):
    df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Accuracy&#39;</span>,<span style="color:#e6db74">&#39;Precision&#39;</span>,<span style="color:#e6db74">&#39;Recall&#39;</span>,<span style="color:#e6db74">&#39;F1-score&#39;</span>])
    <span style="color:#66d9ef">for</span> y_pred <span style="color:#f92672">in</span> args:
        accuracy <span style="color:#f92672">=</span> accuracy_score(y_test, y_pred)
        precision <span style="color:#f92672">=</span> precision_score(y_test, y_pred)
        recall <span style="color:#f92672">=</span> recall_score(y_test, y_pred)
        f1 <span style="color:#f92672">=</span> f1_score(y_test, y_pred)

        df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#39;Accuracy&#39;</span>: accuracy, <span style="color:#e6db74">&#39;Precision&#39;</span>: precision, <span style="color:#e6db74">&#39;Recall&#39;</span>: recall, <span style="color:#e6db74">&#39;F1-score&#39;</span>: f1}, ignore_index<span style="color:#f92672">=</span>True)
    <span style="color:#66d9ef">return</span> df
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">results_cv <span style="color:#f92672">=</span> classification_table(y_test,y_pred_cv_naive, y_pred_cv_log, y_pred_cv_svm)
results_cv<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Naive Bayes CV&#39;</span>, <span style="color:#e6db74">&#39;Logistic Regression CV&#39;</span>,<span style="color:#e6db74">&#39;SVM CV&#39;</span>]
results_cv
</code></pre></div><pre><code>                        Accuracy   Precision Recall    F1-score
Naive Bayes CV          0.816667   0.822981  0.957543  0.885177
Logistic Regression CV  0.810667   0.848434  0.905149  0.875874
SVM CV                  0.738000   0.738000  1.000000  0.849252
</code></pre>
<h2 id="tokenization-using-tfidfvectorizer">Tokenization using TfidfVectorizer</h2>
<p>Rather than compute the frequency of words in a text, tf-idf, which stands for term frequency - inverse document frequency, computes how relevant a term is in a document. Take note that the following calculations are used for scikit-learn&rsquo;s TfidfVectorizer so how tf-idf is calculated in other cases may vary. The details are as follows:</p>
<p><strong>TF (Term Frequency)</strong> - Measures the frequency of a word in a text, calculated by taking the number of times the word occurs in the text divided by the total number of words in the text.</p>
<p><strong>IDF (Inverse Document Frequency)</strong> - Measures how much information the word provides, i.e., if it&rsquo;s common or rare across all text, calculated as follows: ln(n + 1 / df + 1) + 1, where n refers to the total number of texts and df (document frequency) refers to the number of texts that contain the word. IDF diminishes the weight of terms that occur very frequently in the document set and increases the weight of terms that occur rarely.</p>
<p><strong>TF-IDF (Term Frequency - Inverse Document Frequency)</strong> - Reflects how important a word is to a document, calculated by taking TF multiplied by IDF</p>
<p>The tf-idf vectors are then normalized by the Euclidean norm, resulting in the output produced by TfidfVectorizer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tfidf_vect <span style="color:#f92672">=</span> TfidfVectorizer(ngram_range <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))
tfidf_vect_train <span style="color:#f92672">=</span> tfidf_vect<span style="color:#f92672">.</span>fit_transform(X_train)
tfidf_vect_train <span style="color:#f92672">=</span> tfidf_vect_train<span style="color:#f92672">.</span>toarray()
tfidf_vect_test<span style="color:#f92672">=</span> tfidf_vect<span style="color:#f92672">.</span>transform(X_test)
tfidf_vect_test <span style="color:#f92672">=</span> tfidf_vect_test<span style="color:#f92672">.</span>toarray()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd<span style="color:#f92672">.</span>DataFrame(tfidf_vect_train, columns <span style="color:#f92672">=</span> tfidf_vect<span style="color:#f92672">.</span>get_feature_names())<span style="color:#f92672">.</span>head()
</code></pre></div><pre><code>   aa   aaa    aaaaa    aaaaand  aaaaing  aaas  aaron  aas  ab   aback  ...  zora  zoras zr   zul  zumba  zur  ðÿ   المطلوبةbr  بالجودة  ليست
0  0.0  0.0    0.0      0.0      0.0      0.0   0.0    0.0  0.0  0.0    ...  0.0   0.0   0.0  0.0  0.0    0.0  0.0  0.0         0.0   0.0
1  0.0  0.0    0.0      0.0      0.0      0.0   0.0    0.0  0.0  0.0    ...  0.0   0.0   0.0  0.0  0.0    0.0  0.0  0.0         0.0   0.0
2  0.0  0.0    0.0      0.0      0.0      0.0   0.0    0.0  0.0  0.0    ...  0.0   0.0   0.0  0.0  0.0    0.0  0.0  0.0         0.0   0.0
3  0.0  0.0    0.0      0.0      0.0      0.0   0.0    0.0  0.0  0.0    ...  0.0   0.0   0.0  0.0  0.0    0.0  0.0  0.0         0.0   0.0
4  0.0  0.0    0.0      0.0      0.0      0.0   0.0    0.0  0.0  0.0    ...  0.0   0.0   0.0  0.0  0.0    0.0  0.0  0.0         0.0   0.0
</code></pre>
<h2 id="modelling-tfidfvectorizer">Modelling (TfidfVectorizer)</h2>
<p>Repeat the modelling process on the text tokenized using TfidfVectorizer.</p>
<h3 id="naive-bayes-1">Naive Bayes</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tv_naive <span style="color:#f92672">=</span> MultinomialNB()<span style="color:#f92672">.</span>fit(tfidf_vect_train, y_train)
y_pred_tv_naive <span style="color:#f92672">=</span> tv_naive<span style="color:#f92672">.</span>predict(tfidf_vect_test)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_tv_naive)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix4.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_cv_naive))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.78      0.42      0.55       393
           1       0.82      0.96      0.89      1107

    accuracy                           0.82      1500
   macro avg       0.80      0.69      0.72      1500
weighted avg       0.81      0.82      0.80      1500
</code></pre>
<h3 id="logistic-regression-1">Logistic Regression</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tv_log <span style="color:#f92672">=</span> LogisticRegression(max_iter<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>)<span style="color:#f92672">.</span>fit(tfidf_vect_train, y_train)
y_pred_tv_log <span style="color:#f92672">=</span> tv_log<span style="color:#f92672">.</span>predict(tfidf_vect_test)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_tv_log)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix5.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_tv_log))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.82      0.31      0.45       393
           1       0.80      0.98      0.88      1107

    accuracy                           0.80      1500
   macro avg       0.81      0.64      0.66      1500
weighted avg       0.80      0.80      0.77      1500
</code></pre>
<h3 id="support-vector-machine">Support Vector Machine</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">tv_svm <span style="color:#f92672">=</span> SVC(gamma<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;auto&#39;</span>)<span style="color:#f92672">.</span>fit(tfidf_vect_train, y_train)
y_pred_tv_svm <span style="color:#f92672">=</span> tv_svm<span style="color:#f92672">.</span>predict(tfidf_vect_test)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred_tv_svm)

<span style="color:#75715e"># Create graphics for confusion matrix</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Bad&#39;</span>,<span style="color:#e6db74">&#39;Good&#39;</span>]
ax<span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplot()
sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span>True, ax <span style="color:#f92672">=</span> ax, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;d&#34;</span>);

<span style="color:#75715e"># Labels, title and ticks</span>
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Predicted labels&#39;</span>);ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True labels&#39;</span>);
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>);
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_ticklabels(labels); ax<span style="color:#f92672">.</span>yaxis<span style="color:#f92672">.</span>set_ticklabels(labels)
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="https://nchin212.github.io/images/sentiment_analysis/matrix6.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(classification_report(y_test, y_pred_tv_svm))
</code></pre></div><pre><code>              precision    recall  f1-score   support

           0       0.00      0.00      0.00       393
           1       0.74      1.00      0.85      1107

    accuracy                           0.74      1500
   macro avg       0.37      0.50      0.42      1500
weighted avg       0.54      0.74      0.63      1500
</code></pre>
<h3 id="summary-of-results-1">Summary of Results</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">results_tv <span style="color:#f92672">=</span> classification_table(y_test,y_pred_tv_naive, y_pred_tv_log, y_pred_tv_svm)
results_tv<span style="color:#f92672">.</span>index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Naive Bayes TV&#39;</span>, <span style="color:#e6db74">&#39;Logistic Regression TV&#39;</span>,<span style="color:#e6db74">&#39;SVM TV&#39;</span>]
results_tv
</code></pre></div><pre><code>                        Accuracy   Precision Recall   F1-score
Naive Bayes TV          0.740667   0.739973  1.00000  0.850557
Logistic Regression TV  0.801333   0.799408  0.97561  0.878763
SVM TV                  0.738000   0.738000  1.00000  0.849252
</code></pre>
<h2 id="final-results">Final Results</h2>
<p>Combine the 2 summary of results.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">combined <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([results_cv,results_tv], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
combined
</code></pre></div><pre><code>                        Accuracy   Precision Recall    F1-score
Naive Bayes CV          0.816667   0.822981  0.957543  0.885177
Logistic Regression CV  0.810667   0.848434  0.905149  0.875874
SVM CV                  0.738000   0.738000  1.000000  0.849252
Naive Bayes TV          0.740667   0.739973  1.000000  0.850557
Logistic Regression TV  0.801333   0.799408  0.975610  0.878763
SVM TV                  0.738000   0.738000  1.000000  0.849252
</code></pre>
<p>Since the data is quite unbalanced, accuracy will not be a good indicator for which is the better model since the models will be biased towards the majority class. Thus, we should compare the f1-scores.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">3</span>)
bar_width <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>
b1 <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>bar(x, combined<span style="color:#f92672">.</span>loc[combined<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>contains(<span style="color:#e6db74">&#39;CV&#39;</span>), <span style="color:#e6db74">&#39;F1-score&#39;</span>],
            width<span style="color:#f92672">=</span>bar_width, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;CountVectorizer&#39;</span>)
b2 <span style="color:#f92672">=</span> ax<span style="color:#f92672">.</span>bar(x <span style="color:#f92672">+</span> bar_width, combined<span style="color:#f92672">.</span>loc[combined<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>contains(<span style="color:#e6db74">&#39;TV&#39;</span>), <span style="color:#e6db74">&#39;F1-score&#39;</span>],
            width<span style="color:#f92672">=</span>bar_width, label<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; TfidfVectorizer&#39;</span>)

<span style="color:#75715e"># Add legend and y</span>
ax<span style="color:#f92672">.</span>legend()
ax<span style="color:#f92672">.</span>set_ylim(<span style="color:#ae81ff">0.6</span>,<span style="color:#ae81ff">0.9</span>)

<span style="color:#75715e"># Fix x-axis labels</span>
ax<span style="color:#f92672">.</span>set_xticks(x <span style="color:#f92672">+</span> bar_width <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>)
ax<span style="color:#f92672">.</span>set_xticklabels([<span style="color:#e6db74">&#39;Naive Bayes&#39;</span>,<span style="color:#e6db74">&#39;Logistic Regression&#39;</span>, <span style="color:#e6db74">&#39;SVM&#39;</span>])

<span style="color:#75715e"># Add axis and chart labels.</span>
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;F1-score&#39;</span>)
ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;F1-score by Model and Vectorizer&#39;</span>, pad<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)
</code></pre></div><pre><code>Text(0.5, 1.0, 'F1-score by Model and Vectorizer')
</code></pre>
<p><img src="https://nchin212.github.io/images/sentiment_analysis/bar4.png" alt="png"></p>
<p>Naive Bayes appears to perform better on the data tokenized using CountVectorizer as compared to TfidfVectorizer while there is not much difference for Logistic Regression and SVM. Overall, the models are able to classify the positive and negative reviews very well and the best model is Naive Bayes with CountVectorizer with a f1-score of 88.5%. More analysis such as making the data more balanced or performing hyperparameter tuning could improve the model results.</p>
<p><a href="https://github.com/nchin212/Sentiment_Analysis">Link to Github repository</a></p>
<ul class="pa0">
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/Python" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Python</a>
   </li>
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/SentimentAnalysis" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SentimentAnalysis</a>
   </li>
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/NaturalLanguageProcessing" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">NaturalLanguageProcessing</a>
   </li>
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/NaiveBayes" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">NaiveBayes</a>
   </li>
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/LogisticRegression" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">LogisticRegression</a>
   </li>
  
   <li class="list">
     <a href="https://nchin212.github.io/tags/SVM" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">SVM</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-nchin212-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">What&#39;s in this post</p>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#data">Data</a></li>
    <li><a href="#loading-in-the-data">Loading in the Data</a></li>
    <li><a href="#data-cleaning">Data Cleaning</a></li>
    <li><a href="#text-cleaning">Text Cleaning</a></li>
    <li><a href="#exploratory-data-analysis">Exploratory Data Analysis</a>
      <ul>
        <li><a href="#distribution-of-star-ratings">Distribution of Star Ratings</a></li>
        <li><a href="#distribution-of-number-of-words">Distribution of Number of Words</a></li>
        <li><a href="#distribution-of-good-reviews">Distribution of Good Reviews</a></li>
        <li><a href="#most-frequent-words">Most frequent words</a></li>
        <li><a href="#most-frequent-words-for-positive-sentiment">Most frequent words for positive sentiment</a></li>
        <li><a href="#most-frequent-words-for-negative-sentiment">Most frequent words for negative sentiment</a></li>
      </ul>
    </li>
    <li><a href="#tokenization-using-countvectorizer">Tokenization using CountVectorizer</a></li>
    <li><a href="#modelling-countvectorizer">Modelling (CountVectorizer)</a>
      <ul>
        <li><a href="#naive-bayes">Naive Bayes</a></li>
        <li><a href="#logistic-regression">Logistic Regression</a></li>
        <li><a href="#support-vector-machine-svm">Support Vector Machine (SVM)</a></li>
        <li><a href="#summary-of-results">Summary of Results</a></li>
      </ul>
    </li>
    <li><a href="#tokenization-using-tfidfvectorizer">Tokenization using TfidfVectorizer</a></li>
    <li><a href="#modelling-tfidfvectorizer">Modelling (TfidfVectorizer)</a>
      <ul>
        <li><a href="#naive-bayes-1">Naive Bayes</a></li>
        <li><a href="#logistic-regression-1">Logistic Regression</a></li>
        <li><a href="#support-vector-machine">Support Vector Machine</a></li>
        <li><a href="#summary-of-results-1">Summary of Results</a></li>
      </ul>
    </li>
    <li><a href="#final-results">Final Results</a></li>
  </ul>
</nav>
  </div>




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="https://nchin212.github.io/post/credit_fraud/">Credit Card Fraud Detection</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://nchin212.github.io/post/customer_segmentation/">Customer Segmentation</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://nchin212.github.io/post/word_prediction/">Word Prediction</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://nchin212.github.io" >
    &copy;  Nicholas Chin Wei Lun 2021 
  </a>
    <div>








<a href="https://github.com/nchin212" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>

    

  <script src="https://nchin212.github.io/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
